# Sprint retrospective: Week 3

- **Scrum Master:** Cristian Botocan
- **Note Taker:** Mathanrajan Sundarrajan

## Tasks
*All team members:*
- [x] Testing of newly implemented features.
- [x] Decide on heuristics for highlighting in copy-paste.(After consulting with the clients we decided to design a config file after we are done with the must-have requirements)
- [x] Decide on heuristics for the items of the checklist.
- [x] Decide strategy to detect the method under test.


- *Frontend (Cristian, Mathanrajan):*
    - [x] Fix the inconsistency bug in the UI for the test case.
    - [x] Create the mockups for checklist -> show them to the client.
    - [x] Create the mockups for assertion suggestion-> show them to the client.
    - [x] Create the mockups for coverage -> show them to the client.
    - [x] Embed the functionality of the checklist with the UI.
    - [x] Implement the UI for the assertion suggestions.
    - [x] Refine the Copy Paste tab to use a Tree instead of a list of Panels.
    - [x] Add shortcuts for the buttons (Copy Paste feature).
    - [x] Add shortcuts for the buttons (Checklist feature).



- *Backend (Jorge, Pavlos, Piyush):*
    - [x] Fix the null pointer bug from the loading tests feature.
    - [x] Fix the highlighting bug.
    - [x] Implement the proper error handling.
    - [x] Implement the checklist generator.
    - [x] Implement the getting the method under test functionality.
    - [x] Implement the assertion suggestions.
    - [x] Implement foundations for coverage feature.
    - [x] Design the argument mutation side effect for the assertion suggestion.



## Main Problems Encountered/ Highlights
- **All team members:**
    - It was generally difficult to understand and find the proper documentation for different tasks.
    - We have also done the peer review, so we think that it will help us for improving the atmosphere in the team
- **UI Team (Cristian, Mathan):**
    - This week we made the mockups for assertion suggestion, code coverage, and checklist generation on Monday. It took a little bit more than we expected, since
    - We worked on changing the UI for the test case tab from JPanels to Tree. One of the main problems we faced here was understanding how to create a custom renderer for tree works. From what we understood, the renderer doesn't create any live components, meaning you cannot interact with the components which were rendered by the renderer. So, in order to make the components "live", we attached listeners to the tree which checks for mouse clicks. If the mouse click was on top of a button, the respective button action is done.
    - Mathan - Most of my development time was spent on figuring out how to retrieve a specific object, say the current editor, from the objects I can currently access. Since the APIs are quite complex and there are multiple ways to access an object, figuring out the proper way through which I can access an object took some time. I also worked on adding hotkeys for the test case tab and the copy-paste tab. They didn't take a lot of time to implement as I learned how listeners worked while working on making the Tree structure for the test case tab.
    - Cristian - I also worked on the implementation of the checklist, since we have to connect the backend functionality with the UI part. The most time-consuming part was to find proper documentation and try to reformat the previous tree structure and its renderers. On the other hand, I have worked on the assertion suggestion feature, for which I could find a lot of possibilities for integrating it with the IntelliJ UI. For instance, you can have an intention action lists for which you can find the documentation and how it works in the settings panel of the IntelliJ


- **Backend Team (Jorge, Pavlos, Piyush):**
    - The skeleton for the checklist generation feature was completed as part of an issue last week. This week's issue was associated with filling in the concrete implementations of the ChecklistGenerationStratergy classes themselves. This was quite a parallelizable issue and thus we split these classes amongst the backend team members. We incorrectly presumed this to not take up that much of our time since we started off with splitting only the bare minimum classes in the skeleton from last week. There were 3 classes under branching statements, 3 under loop statements, and 3 others along with tests for each. So naturally, we split 3 each. However, later we later came up with an improvement for condition checklists where instead of 2^n cases being generated by a naive implementation, we could bring it down to n+1 using MC/DC. Implementing this is, however, not straightforward and Jorge was assigned exclusively to this task. We also realized we had left out forEach statements, ternary operators, and parameters from the checklist. Thus, all of the remaining checklist classes were redistributed between Pavlos and Piyush. Because of these improvements, the time and code required shot up by a lot with the branch having 54 commits. Although we were able to make the basic checklist and add improvements to the checklist, we should better estimate the size of issues next time.
    - Pavlos - One of the main issues I encountered this week was setting up our testing workflow to work with mocks. We needed the mocks to be able to write stable tests for our checklist item generation strategies. The first issue we encountered with this Mockito (the mocking framework we have all used in the past) does not work well with Kotlin because Kotlin's class system is much stricter than Java's.  Fortunately, there is Kotlin specific mocking framework called MockK that was easy to set up and turned out to be great to work with. The second issue, which was considerably more serious than the first was that the IntelliJ SDK testing frameworks are not made to use mocks.  This is even documented by the JetBrains team on the SDK documentation. After a lot of hours of debugging and trying to understand why things were not working, I made a slight change in our codebase design to allow for easier dependency injection. We spent a lot of time making the changes and thus were considerably slowed down. In the end, however, we did test our code properly.
    - Piyush - Because of underestimating the costs of improvements like the MC/DC and reassignment of work, I was responsible for 5 checklist classes and their tests. Additionally, all but one were delegate condition to the MC/DC generation strategy. So for the same reason mentioned above, since each of them involved mocking the ConditionChecklistGenerationStrategy, the MockK setup took up a lot of time. However, it was very straightforward after the skeleton for one of the classes was implemented as all classes followed a similar mock strategy. Personally, I also found that I make a lot of changes in one commit as compared to my fellow developers so I will focus on unifying their size in future sprints.
    - Jorge - This week I spent most of my time implementing the MC/DC algorithm for generating test cases from a condition. I initially underestimated this task as the algorithm is relatively straightforward. Nonetheless, it ended up being quite complex, in particular, I had difficulties extracting a propositional expression from the condition, but after researching the literature and some parsing libraries I managed to implement a wishing version.


## What can we improve?

- As mentioned before, in the future we should have smaller merge requests. Maybe this is due to underestimating the size of the issue. Even if we find ourselves doing something like that in the future we should make sure to have smaller more frequent MRs.
- Instead of coming up with improvements during the feature development phase itself, in the future, we should first finis the base feature as discussed with the client. Only after this improvements and refinements should be done. A good example can be the MC/DC part from the backend strategy of the checklist.
- The clients added two more requirements to the project, namely publishing the plugin on the IntelliJ marketplace and creating a Github repository to deploy it open source. We should plan out a strategy to finish all must-haves and bonus features which we already did, but also incorporate these to-dos in the planning too.

## State of the Project
- We have a complete version (both frontend and backend) of the copy-paste feature. Moreover, we also have almost complete versions of assertion suggestions and checklist. These can also be performed by various hotkeys.
- For the checklist part, we will come up with a data structure that can improve the performance of loading checklists that have a big size in terms of the number of items. Thus, some more refinements will be done in the near future.

